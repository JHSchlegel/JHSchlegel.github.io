<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jan Schlegel">
<meta name="dcterms.date" content="2025-02-07">

<title>Comparing Univariate and Multivariate Models for Value at Risk Forecasting – Jan Schlegel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-8aa8884591a9136173b71f6048871fae.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="color-scheme" content="dark light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jan Schlegel</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/jan-heinrich-schlegel/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JHSchlegel"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Comparing Univariate and Multivariate Models for Value at Risk Forecasting</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Simulation</div>
                <div class="quarto-category">R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jan Schlegel </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 7, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">Abstract</div>
      This post explores the effectiveness of univariate and multivariate GARCH-based models in forecasting Value at Risk (VaR) for a long equity portfolio. While multivariate models generally perform better in backtests, univariate models often fall short. However, neither model type consistently outperforms the other in predictive accuracy, highlighting the trade-offs between simplicity and complexity in risk forecasting.
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-introduction" id="toc-sec-introduction" class="nav-link active" data-scroll-target="#sec-introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#sec-methodology" id="toc-sec-methodology" class="nav-link" data-scroll-target="#sec-methodology"><span class="header-section-number">2</span> Methodology</a>
  <ul class="collapse">
  <li><a href="#sec-univariate" id="toc-sec-univariate" class="nav-link" data-scroll-target="#sec-univariate"><span class="header-section-number">2.1</span> Univariate Models</a></li>
  <li><a href="#sec-multivariate" id="toc-sec-multivariate" class="nav-link" data-scroll-target="#sec-multivariate"><span class="header-section-number">2.2</span> Multivariate Models</a></li>
  <li><a href="#sec-data" id="toc-sec-data" class="nav-link" data-scroll-target="#sec-data"><span class="header-section-number">2.3</span> Data</a></li>
  <li><a href="#sec-VaR-forecasts" id="toc-sec-VaR-forecasts" class="nav-link" data-scroll-target="#sec-VaR-forecasts"><span class="header-section-number">2.4</span> Value at Risk Forecasts</a></li>
  <li><a href="#sec-backtesting" id="toc-sec-backtesting" class="nav-link" data-scroll-target="#sec-backtesting"><span class="header-section-number">2.5</span> Backtesting</a></li>
  <li><a href="#sec-comparison-PA" id="toc-sec-comparison-PA" class="nav-link" data-scroll-target="#sec-comparison-PA"><span class="header-section-number">2.6</span> Comparison of Predictive Ability</a></li>
  </ul></li>
  <li><a href="#sec-results" id="toc-sec-results" class="nav-link" data-scroll-target="#sec-results"><span class="header-section-number">3</span> Results</a>
  <ul class="collapse">
  <li><a href="#value-at-risk-backtests" id="toc-value-at-risk-backtests" class="nav-link" data-scroll-target="#value-at-risk-backtests"><span class="header-section-number">3.1</span> Value at Risk Backtests</a></li>
  <li><a href="#conditional-predictive-ability-tests" id="toc-conditional-predictive-ability-tests" class="nav-link" data-scroll-target="#conditional-predictive-ability-tests"><span class="header-section-number">3.2</span> Conditional Predictive Ability Tests</a></li>
  </ul></li>
  <li><a href="#sec-conclusion" id="toc-sec-conclusion" class="nav-link" data-scroll-target="#sec-conclusion"><span class="header-section-number">4</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/var_visualization.png" class="img-fluid figure-img"></p>
<figcaption>Value at Risk (VaR) is a crucial metric in modern financial risk management</figcaption>
</figure>
</div>
<section id="sec-introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>The past four decades have been shaped by extreme events in financial markets, such as the Black Monday crash, the dot-com bubble, and the 2008 global financial crisis. These supposedly rare events highlighted that reducing systemic risk is crucial for financial stability <span class="citation" data-cites="embrechts_2014">(<a href="#ref-embrechts_2014" role="doc-biblioref">Embrechts et al. 2014</a>)</span>. This led to the introduction and tightening of the Basel Accords, which use risk measures to determine appropriate risk capital requirements for financial institutions.</p>
<p>Value at Risk (VaR) remains the most popular measure for downside market risk, despite a shift towards the severity-based expected shortfall (ES) <span class="citation" data-cites="embrechts_2014">(<a href="#ref-embrechts_2014" role="doc-biblioref">Embrechts et al. 2014</a>)</span>. For a long equity portfolio, the <span class="math inline">\(p\)</span>% VaR for period <span class="math inline">\(t\)</span> forecasted at time <span class="math inline">\(t-1\)</span> is defined as the negative <span class="math inline">\(p\)</span>-quantile of the conditional portfolio return distribution:</p>
<p><span id="eq-VaR_def"><span class="math display">\[
\text{VaR}_t^p=-Q_p(r_{\text{PF},t}|\mathcal{F}_{t-1})=-\inf_x\{x\in\mathbb{R}:\mathbb{P}(r_{\text{PF},t}\leq x|\mathcal{F}_{t-1})\geq p\},\quad p\in(0,1).
\tag{1}\]</span></span></p>
<p>Here, <span class="math inline">\(Q_p(\cdot)\)</span> denotes the quantile function and <span class="math inline">\(\mathcal{F}_{t-1}\)</span> represents all information available at time <span class="math inline">\(t-1\)</span>. The parameter <span class="math inline">\(p\)</span> indicates that with target probability <span class="math inline">\(p\)</span>, the portfolio losses will exceed the VaR <span class="citation" data-cites="Paolella2006">(<a href="#ref-Paolella2006" role="doc-biblioref">Marc S. Paolella, Kuester, and Mittnik 2006</a>)</span>.</p>
<p>Due to the practical relevance of VaR, it is essential to determine estimation methods that neither severely underestimate nor overestimate future losses. Many models use the generalized autoregressive conditional heteroskedasticity (GARCH) framework <span class="citation" data-cites="bollerslev_garch">(<a href="#ref-bollerslev_garch" role="doc-biblioref">Bollerslev 1986</a>)</span> or extensions to account for volatility clustering and the “leverage effect” in financial time series.</p>
<p>A fundamental question in VaR modeling is whether more complex multivariate models outperform simpler univariate alternatives. <span class="citation" data-cites="Santos2013">Santos, Nogales, and Ruiz (<a href="#ref-Santos2013" role="doc-biblioref">2013</a>)</span> found that multivariate models significantly outperform univariate counterparts for large portfolios, while <span class="citation" data-cites="kole_forecasting">Kole et al. (<a href="#ref-kole_forecasting" role="doc-biblioref">2017</a>)</span> found that multivariate models have greater predictive ability, though differences are often not significant. They also found that data frequency is more important than model choice.</p>
<p>This study compares factor copula-DCC-NGARCH models introduced by <span class="citation" data-cites="Fortin2022">Fortin, Simonato, and Dionne (<a href="#ref-Fortin2022" role="doc-biblioref">2022</a>)</span> with established models like the diagonal MixN(k)-GARCH <span class="citation" data-cites="MN2004">(<a href="#ref-MN2004" role="doc-biblioref">Haas, Mittnik, and Paolella 2004</a>)</span> and the COMFORT model class <span class="citation" data-cites="COMFORT_2015">(<a href="#ref-COMFORT_2015" role="doc-biblioref">Marc S. Paolella and Polak 2015</a>)</span>. We show that multivariate models display desirable VaR properties in terms of correct unconditional coverage and independence of violations, though we don’t find sufficient evidence to claim that multivariate approaches outperform univariate procedures in terms of forecast ability, or vice versa.</p>
</section>
<section id="sec-methodology" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-methodology"><span class="header-section-number">2</span> Methodology</h2>
<section id="sec-univariate" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-univariate"><span class="header-section-number">2.1</span> Univariate Models</h3>
<p>For univariate models, we assume the following portfolio return dynamics:</p>
<p><span class="math display">\[
r_{\text{PF},t} = \mu + \epsilon_t
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\epsilon_t = \sigma_t z_t, \quad z_t \stackrel{iid}{\sim} F(0,1)
\]</span></p>
<p>Here, <span class="math inline">\(F(0,1)\)</span> is a standardized distribution, <span class="math inline">\(\mu\)</span> is the unconditional location, and <span class="math inline">\(\sigma_t\)</span> is the scale parameter. The conditional variance <span class="math inline">\(\sigma_t^2 = \mathbb{V}[r_{\text{PF},t}|\mathcal{F}_{t-1}]\)</span> is modeled as non-constant.</p>
<section id="garch-and-extensions" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="garch-and-extensions"><span class="header-section-number">2.1.1</span> GARCH and Extensions</h4>
<p>The standard GARCH(1,1) model <span class="citation" data-cites="bollerslev_garch">(<a href="#ref-bollerslev_garch" role="doc-biblioref">Bollerslev 1986</a>)</span> is formulated as:</p>
<p><span id="eq-GARCH"><span class="math display">\[
\sigma_t^2 = \omega + \alpha\epsilon_{t-1}^2 + \beta\sigma_{t-1}^2
\tag{2}\]</span></span></p>
<p>where <span class="math inline">\(\omega &gt; 0, \alpha \geq 0\)</span>, and <span class="math inline">\(\beta \geq 0\)</span>. For covariance stationarity, the parameters must satisfy <span class="math inline">\(\alpha + \beta &lt; 1\)</span>.</p>
<p>A special case is the exponentially weighted moving average (EWMA):</p>
<p><span id="eq-EWMA"><span class="math display">\[
\sigma^2_t = \lambda\sigma^2_{t-1} + (1-\lambda)\epsilon_t^2, \quad \lambda \in (0,1)
\tag{3}\]</span></span></p>
<p>This formulation puts more weight on recent observations, but is not covariance stationary since <span class="math inline">\(\lambda + (1-\lambda) = 1\)</span>.</p>
<p>To account for the “leverage effect” (negative news increasing volatility more than positive news of equal magnitude), we include the GJR-GARCH(1,1) model <span class="citation" data-cites="GJR">(<a href="#ref-GJR" role="doc-biblioref">Glosten, Jagannathan, and Runkle 1993</a>)</span>:</p>
<p><span id="eq-GJR"><span class="math display">\[
\sigma_t^2 = \omega + (\alpha + \gamma I_{t-1})\epsilon_{t-1}^2 + \beta\sigma_{t-1}^2
\tag{4}\]</span></span></p>
<p>where <span class="math inline">\(I_{t-1} = \mathbb{I}_{\{\epsilon_{t-1} &lt; 0\}}\)</span> is an indicator function.</p>
<p>Another asymmetric model is the NGARCH(1,1) <span class="citation" data-cites="NGARCH">(<a href="#ref-NGARCH" role="doc-biblioref">R. F. Engle and Ng 1993</a>)</span>:</p>
<p><span class="math display">\[
\sigma_t^2 = \omega + \alpha\sigma_{t-1}^2(\epsilon_{t-1} - \theta)^2 + \beta\sigma_{t-1}^2
\]</span></p>
<p>For <span class="math inline">\(\theta &gt; 0\)</span>, negative innovations have a larger impact on conditional variance than positive errors of the same magnitude.</p>
</section>
<section id="mixed-normal-garch" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="mixed-normal-garch"><span class="header-section-number">2.1.2</span> Mixed Normal GARCH</h4>
<p>We also include the k-component mixed normal GARCH(1,1) (MixN(k)-GARCH) <span class="citation" data-cites="MN2004">(<a href="#ref-MN2004" role="doc-biblioref">Haas, Mittnik, and Paolella 2004</a>)</span>, where the conditional distribution of the error term <span class="math inline">\(\epsilon_t\)</span> is assumed to be mixed normal with zero mean:</p>
<p><span class="math display">\[
\epsilon_t|\mathcal{F}_{t-1} \sim \text{Mix}_k\text{N}(p_1,...,p_k, \mu_1,...,\mu_k, \sigma_{1,t}^2,...,\sigma_{k,t}^2), \quad \sum_{i=1}^k p_i\mu_i = 0
\]</span></p>
<p>The associated conditional variances follow GARCH processes:</p>
<p><span class="math display">\[
\sigma_{i,t}^2 = \omega_i + \alpha_i\epsilon_{i,t-1}^2 + \beta_i\sigma_{i,t-1}^2, \quad i=1,...,k
\]</span></p>
</section>
</section>
<section id="sec-multivariate" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-multivariate"><span class="header-section-number">2.2</span> Multivariate Models</h3>
<section id="factor-copula-dcc-garch-model" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="factor-copula-dcc-garch-model"><span class="header-section-number">2.2.1</span> Factor Copula-DCC-GARCH Model</h4>
<p>The factor copula model proposed by <span class="citation" data-cites="Fortin2022">Fortin, Simonato, and Dionne (<a href="#ref-Fortin2022" role="doc-biblioref">2022</a>)</span> uses equity factors to capture the main risks of stock returns. It utilizes the Carhart four-factor model <span class="citation" data-cites="Carhart1997">(<a href="#ref-Carhart1997" role="doc-biblioref">Carhart 1997</a>)</span>, which adds a momentum factor to the Fama-French three-factor model <span class="citation" data-cites="FamaFrench">(<a href="#ref-FamaFrench" role="doc-biblioref">Fama and French 1993</a>)</span>:</p>
<p><span id="eq-Carhart"><span class="math display">\[
r_{k,t} - r_{f,t} = \alpha_{k,t} + \beta_{k, \text{RMRF}}\text{RMRF}_t + \beta_{k,\text{SMB}}\text{SMB}_t + \beta_{k,\text{HML}}\text{HML}_t + \beta_{k, \text{MOM}}\text{MOM}_t + \varepsilon_{k,t}
\tag{5}\]</span></span></p>
<p>or in vector form:</p>
<p><span id="eq-CarhartVec"><span class="math display">\[
r_{k,t} - r_{f,t} = \alpha_{k,t} + \mathbf{\beta}_k'\mathbf{r}_{\text{F},t} + \varepsilon_{k,t}
\tag{6}\]</span></span></p>
<p>This reduces dimensionality by modeling only four factors instead of all portfolio constituents.</p>
<p>For the factor dynamics, we use the Dynamic Conditional Correlation (DCC) structure <span class="citation" data-cites="DCC">(<a href="#ref-DCC" role="doc-biblioref">R. Engle 2002</a>)</span>, which decomposes the conditional covariance matrix into standard deviations and correlations:</p>
<p><span id="eq-sigma_decomp"><span class="math display">\[
\mathbf{Y}_{t}|\mathcal{F}_{t-1} \sim \mathcal{N}_n(\mathbf{\mu}, \mathbf{\Sigma_t}), \quad \mathbf{\Sigma_t} = \mathbf{D_t}\mathbf{\Gamma_t}\mathbf{D_t}
\tag{7}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{D_t} = \text{diag}(\sigma_{1,t},\sigma_{2,t},...,\sigma_{n,t})\)</span> contains the conditional standard deviations.</p>
<p>To account for non-normality, we use copulas to model the joint conditional distribution of factor returns. Copulas allow modeling marginals independently of the multivariate distribution. By Sklar’s theorem:</p>
<p><span id="eq-Sklar"><span class="math display">\[
\mathbf{F_t}(\mathbf{z_t}) = \mathbf{C_t}(F_{1,t}(z_{1,t}),...,F_{n,t}(z_{n,t}))
\tag{8}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{F_t}(\mathbf{z_t})\)</span> is the joint conditional distribution, <span class="math inline">\(F_{i,t}(\cdot)\)</span> are the conditional marginals, and <span class="math inline">\(\mathbf{C_t}:[0,1]^n \rightarrow [0,1]\)</span> is the conditional copula.</p>
</section>
<section id="comfort-model" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="comfort-model"><span class="header-section-number">2.2.2</span> COMFORT Model</h4>
<p>The Common Market Factor Non-Gaussian Returns (COMFORT) model <span class="citation" data-cites="COMFORT_2015">(<a href="#ref-COMFORT_2015" role="doc-biblioref">Marc S. Paolella and Polak 2015</a>)</span> uses a multivariate generalized hyperbolic (MGHyp) distribution with a CCC or DCC structure for the covariance matrix. This model can be expressed as a continuous normal mixture:</p>
<p><span id="eq-COMFORT"><span class="math display">\[
\mathbf{Y_t} = \mathbf{\mu} + \mathbf{\gamma} G_t + \mathbf{\varepsilon_t}, \quad \mathbf{\varepsilon_t} = \mathbf{\Sigma_t}^{1/2}\sqrt{G_t}\mathbf{Z_t}
\tag{9}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{Z_t} \stackrel{iid}{\sim} \mathcal{N}_n(\mathbf{0},\mathbf{I_n})\)</span> and the mixing random variables <span class="math inline">\(G_t|\mathcal{F}_{t-1} \sim \text{GIG}(\lambda_t,\chi_t,\psi_t)\)</span> follow a generalized inverse Gaussian distribution.</p>
<p>An important property of the MGHyp distribution is that it is closed under linear operations. Therefore, portfolio returns <span class="math inline">\(r_{\text{PF},t} = \mathbf{w}'\mathbf{Y_t}\)</span> are univariate GHyp distributed:</p>
<p><span id="eq-GHyp_PF"><span class="math display">\[
r_{\text{PF},t}|\mathcal{F}_{t-1} \sim \text{GHyp}(\mathbf{w}'\mathbf{\mu},\mathbf{w}'\mathbf{\gamma},\mathbf{w}'\mathbf{\Sigma_t}\mathbf{w},\lambda_t,\chi_t, \psi_t)
\tag{10}\]</span></span></p>
</section>
</section>
<section id="sec-data" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-data"><span class="header-section-number">2.3</span> Data</h3>
<p>We use an equally weighted portfolio of ten large-cap stocks (identical to those used by <span class="citation" data-cites="Fortin2022">Fortin, Simonato, and Dionne (<a href="#ref-Fortin2022" role="doc-biblioref">2022</a>)</span>): Boeing, Caterpillar, Chevron, Coca-Cola, Exxon, GE, IBM, Merck, P&amp;G, and UTC. However, we analyze 2,767 daily returns from January 2, 2001, to December 30, 2011, rather than weekly returns.</p>
<p>The return data shows that most factors and stocks have means close to zero, with the median larger than the mean in most cases. The mean absolute deviation (MAD) is considerably smaller than the standard deviation, indicating the presence of outliers. Most returns are left-skewed with leptokurtic behavior, and all return distributions reject the assumption of normality based on Jarque-Bera statistics.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-acf-factors" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-acf-factors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/ACF_Plots_Factors.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-acf-factors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: ACF Plots of the Fama-French-Carhart Factors
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-acf-factors" class="quarto-xref">Figure&nbsp;1</a> shows autocorrelation function (ACF) plots for the factors. It is evident that the factors exhibit stronger autocorrelation in absolute returns than in the returns themselves, justifying the use of volatility models.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-md-chisq-plots" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-md-chisq-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/MD_Chisq_Plot.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-md-chisq-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Chi-Square Q-Q Plots of the Stock and Factor Returns
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-md-chisq-plots" class="quarto-xref">Figure&nbsp;2</a> shows Q-Q plots of the robust squared Mahalanobis distances against <span class="math inline">\(\chi^2\)</span> distributions. The non-linear relationship indicates large multivariate outliers and multivariate non-normality.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-pf-plots" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pf-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/PF_plots.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pf-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Portfolio Returns
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-pf-plots" class="quarto-xref">Figure&nbsp;3</a> demonstrates blatant volatility clustering (Panel A) and that the portfolio returns are not normally distributed (Panel B).</p>
</section>
<section id="sec-VaR-forecasts" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-VaR-forecasts"><span class="header-section-number">2.4</span> Value at Risk Forecasts</h3>
<p>For all models, we assume a constant conditional mean over time. Forecasting uses a rolling window approach with the previous 1,000 observations to predict the one-step-ahead VaR.</p>
<p>For univariate GARCH models (except MixN(k)-GARCH), we use the analytical formula:</p>
<p><span id="eq-VaR_uni"><span class="math display">\[
\widehat{\text{VaR}_t^p} = -\mu_{\text{PF}} - \sigma_{\text{PF}, t} Q_p(z_t|\mathcal{F}_{t-1})
\tag{11}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_{\text{PF}, t}\)</span> is the conditional standard deviation and <span class="math inline">\(Q_p(z_t)\)</span> is the p-quantile of the standardized returns.</p>
<p>For the factor copula-DCC-(N)GARCH models, we simulate factor returns, apply the Carhart model to generate single stock returns, and calculate the portfolio return. The VaR estimate is then the negative p-quantile of the simulated portfolio returns.</p>
<p>For the COMFORT model, we use the p-quantile function of the corresponding conditional univariate GHyp distribution:</p>
<p><span id="eq-COMFORT_VaR"><span class="math display">\[
\widehat{\text{VaR}_t^p} = -Q_p(r_{\text{PF},t}|\mathcal{F}_{t-1})
\tag{12}\]</span></span></p>
</section>
<section id="sec-backtesting" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="sec-backtesting"><span class="header-section-number">2.5</span> Backtesting</h3>
<p>Backtesting checks whether the forecasts exhibit desirable properties. Following <span class="citation" data-cites="CCTest">Christoffersen (<a href="#ref-CCTest" role="doc-biblioref">1998</a>)</span>, we use three likelihood-ratio tests.</p>
<p>Let <span class="math inline">\(I_t\)</span> be the indicator variable for a <span class="math inline">\(\text{VaR}_t^p\)</span> forecast:</p>
<p><span class="math display">\[
I_t = \mathbb{I}_{\{r_{\text{PF},t} &lt; -\text{VaR}_t^p\}} =
\begin{cases}
1 &amp; \text{if } r_{\text{PF},t} &lt; -\text{VaR}_t^p \\
0 &amp; \text{otherwise}
\end{cases}
\]</span></p>
<p>A sequence of VaR forecasts is efficient with respect to <span class="math inline">\(\mathcal{F}_{t-1}\)</span> if:</p>
<p><span id="eq-cc"><span class="math display">\[
\mathbb{E}[I_t|\mathcal{F}_{t-1}] = \mathbb{E}[I_t|I_{t-1},I_{t-2},...,I_1] = p, \quad t=1,2,...,T
\tag{13}\]</span></span></p>
<p>This is equivalent to testing that <span class="math inline">\(\{I_t\}_{t=1}^T \overset{\text{iid}}{\sim} \text{Bernoulli}(p)\)</span>.</p>
<section id="unconditional-coverage-test" class="level4" data-number="2.5.1">
<h4 data-number="2.5.1" class="anchored" data-anchor-id="unconditional-coverage-test"><span class="header-section-number">2.5.1</span> Unconditional Coverage Test</h4>
<p>This tests whether the expected value of <span class="math inline">\(I_t\)</span> equals <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
H_0: \mathbb{E}[I_t] = p \quad \text{versus} \quad H_A: \mathbb{E}[I_t] \neq p
\]</span></p>
<p>The likelihood-ratio test statistic is:</p>
<p><span id="eq-uc"><span class="math display">\[
LR_{uc} = -2\log\left(\frac{L(p;I_1,I_2,...,I_T)}{L(\hat{p};I_1,I_2,...,I_T)}\right) \overset{\text{asy}}{\sim} \chi_1^2
\tag{14}\]</span></span></p>
<p>where <span class="math inline">\(\hat{p} = \frac{n_1}{n_0+n_1}\)</span> is the maximum likelihood estimate of <span class="math inline">\(p\)</span>.</p>
</section>
<section id="independence-test" class="level4" data-number="2.5.2">
<h4 data-number="2.5.2" class="anchored" data-anchor-id="independence-test"><span class="header-section-number">2.5.2</span> Independence Test</h4>
<p>This tests whether the indicator sequence is independently distributed, against a first-order Markov chain alternative:</p>
<p><span id="eq-ind"><span class="math display">\[
LR_{ind} = -2\log\left(\frac{L(\hat{\Pi}_2;I_2,...,I_T|I_1)}{L(\hat{\Pi}_1;I_2,...,I_T|I_1)}\right) \overset{\text{asy}}{\sim} \chi_1^2
\tag{15}\]</span></span></p>
<p>where <span class="math inline">\(\hat{\Pi}_1\)</span> and <span class="math inline">\(\hat{\Pi}_2\)</span> are the estimated transition probability matrices under the alternative and null hypotheses.</p>
</section>
<section id="conditional-coverage-test" class="level4" data-number="2.5.3">
<h4 data-number="2.5.3" class="anchored" data-anchor-id="conditional-coverage-test"><span class="header-section-number">2.5.3</span> Conditional Coverage Test</h4>
<p>This combines the unconditional coverage and independence tests:</p>
<p><span id="eq-cc"><span class="math display">\[
LR_{cc} = -2\log\left(\frac{L(p;I_2,...,I_T|I_1)}{L(\hat{\Pi}_1;I_2,...,I_T|I_1)}\right) \overset{\text{asy}}{\sim} \chi_2^2
\tag{16}\]</span></span></p>
<p>It can also be calculated as:</p>
<p><span class="math display">\[
LR_{cc} = LR_{uc} + LR_{ind}
\]</span></p>
</section>
</section>
<section id="sec-comparison-PA" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="sec-comparison-PA"><span class="header-section-number">2.6</span> Comparison of Predictive Ability</h3>
<p>To rank VaR estimates, we use the “tick” loss function:</p>
<p><span class="math display">\[
L_V(\theta_t, r_{\text{PF},t}) = (r_{\text{PF},t} + \theta_t)(p - \mathbb{I}_{\{r_{\text{PF},t} &lt; -\theta_t\}})
\]</span></p>
<p>This loss function has the property that:</p>
<p><span id="eq-pred_ab"><span class="math display">\[
Q_p(r_{\text{PF},t}|\mathcal{F}_{t-1}) = -\text{VaR}_t^p = \arg\min_{\theta_t} \mathbb{E}[L_V(\theta_t, r_{\text{PF},t})]
\tag{17}\]</span></span></p>
<p>For statistical inference, we use the conditional predictive ability (CPA) test <span class="citation" data-cites="CPATests">(<a href="#ref-CPATests" role="doc-biblioref">Giacomini and White 2006</a>)</span>. The null hypothesis of equal conditional predictive ability is:</p>
<p><span class="math display">\[
H_0: \mathbb{E}[\Delta L_{i,j,t}|\mathcal{F}_{t-1}] = 0 \quad \text{almost surely } \forall t
\]</span></p>
<p>where <span class="math inline">\(\Delta L_{i,j,t} = L_{V_{i,t}} - L_{V_{j,t}}\)</span> is the loss differential between models i and j.</p>
<p>The test statistic is:</p>
<p><span class="math display">\[
GW_{i,j} = T\bar{Z}'\hat{\Omega}\bar{Z} \overset{d}{\rightarrow} \chi^2_q \quad \text{as } T \rightarrow \infty
\]</span></p>
<p>where <span class="math inline">\(Z_t = h_{t-1}\Delta L_{i,j,t}\)</span>, <span class="math inline">\(\bar{Z} = \frac{1}{T}\sum_{t=2}^T Z_t\)</span>, and <span class="math inline">\(\hat{\Omega} = \frac{1}{T}\sum_{t=2}^T Z_t Z_t'\)</span>.</p>
</section>
</section>
<section id="sec-results" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-results"><span class="header-section-number">3</span> Results</h2>
<section id="value-at-risk-backtests" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="value-at-risk-backtests"><span class="header-section-number">3.1</span> Value at Risk Backtests</h3>
<div class="cell">
<div class="cell-output-display">
<div id="fig-md-chisq-plot-OLS" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-md-chisq-plot-OLS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/MD_Chisq_Plot_OLS.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-md-chisq-plot-OLS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Chi-Square Q-Q Plot of the Carhart OLS Residuals
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-md-chisq-plot-OLS" class="quarto-xref">Figure&nbsp;4</a> shows the Q-Q plot of OLS residuals, clearly indicating their non-normality.</p>
<p>Table 1 shows that while all univariate models passed the likelihood ratio test of independence, only a few showed adequate conditional or unconditional coverage. In particular, only the skewed-t GJR-GARCH passed the test of conditional coverage for both VaR levels. In contrast, most multivariate models passed all likelihood ratio tests, with the exception of the multivariate normal (MN)-DCC-GARCH.</p>
<p>It’s notable that using skewed-t NGARCH marginals in the factor copula framework leads to a very low percentage of violations compared to other models. Surprisingly, even using a normal copula with normal GARCH marginals for factor returns produces sound VaR estimates, possibly because much of the multivariate non-normality of stock returns might be captured in the bootstrapped OLS residuals.</p>
<p>Models assuming normality of returns (GARCH, EWMA, and MN-DCC-GARCH) consistently show too many violations, with none displaying adequate conditional or unconditional coverage. For these models, the percentage of violations is higher than the corresponding VaR level. For the COMFORT and factor copula models, however, we observe fewer violations than expected.</p>
<p>The most adequate coverage is achieved by the factor copula-DCC models with GARCH marginals for the 1% VaR level and by the COMFORT models for the 5% level. The factor skewed-t copula with GARCH marginals belongs to the three models with the most appropriate coverage for both VaR percentiles.</p>
<p>Nearly all exceedances for the COMFORT models occurred during or after the 2008 financial crisis, despite passing the independence test. At the 1% VaR level, Gaussian models without leverage effects have approximately three times as many exceedances as expected. At the 5% VaR level, this discrepancy is smaller.</p>
</section>
<section id="conditional-predictive-ability-tests" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="conditional-predictive-ability-tests"><span class="header-section-number">3.2</span> Conditional Predictive Ability Tests</h3>
<p>In terms of average tick loss, univariate models perform well despite their suboptimal backtesting results. The skewed-t GJR model had the lowest and the MN-DCC-GARCH the highest average loss for both VaR levels. Multivariate models achieve better ranks at the 1% level than at the 5% level, with factor copula-based models showing lower average loss than COMFORT models at both levels.</p>
<p>Within the factor copula-DCC models, GARCH marginals achieved lower mean losses than skewed-t NGARCH marginals, reinforcing the hypothesis that bootstrapped OLS residuals account for much of the non-normality in stock returns.</p>
<p>The CPA test results show that the MN-DCC-GARCH is significantly outperformed by every other model. Most rejections occur in univariate vs.&nbsp;univariate or multivariate vs.&nbsp;multivariate comparisons. For multivariate models, factor copula-DCC models using skewed-t NGARCH marginals have significantly higher predictive ability than their counterparts with normal GARCH marginals. The normal copula is superior for skewed-t NGARCH marginals, but for normal GARCH marginals, the t and skewed-t copula versions significantly outperform the normal copula.</p>
<p>At the 5% VaR level, in addition to MN-DCC-GARCH, the MixN(3)-GARCH is also significantly outperformed by all other models. The Student t GJR-GARCH, skewed-t GJR-GARCH, and MixN(2)-GARCH all display significantly higher predictive ability than the COMFORT models.</p>
<p>Interestingly, the skewed-t GJR-GARCH, which significantly outperformed every other univariate model, did not achieve significantly better VaR forecasts than the factor copula-DCC-(N)GARCH models.</p>
</section>
</section>
<section id="sec-conclusion" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-conclusion"><span class="header-section-number">4</span> Conclusion</h2>
<p>Our study assessed various univariate and multivariate models for VaR forecasting. Most univariate models produced inadequate VaR estimates with too many violations, while most multivariate models displayed adequate coverage with independently occurring VaR exceedances.</p>
<p>The CPA tests revealed that the MN-DCC-GARCH model is significantly outperformed by all other models, which is expected given the evident multivariate non-normality of stock returns. However, we found no general, significant outperformance of multivariate models over univariate ones, or vice versa, at either VaR level.</p>
<p>One important finding is that using daily returns (higher frequency data) makes the factor copula-DCC-NGARCH models feasible for VaR forecasting, consistent with <span class="citation" data-cites="kole_forecasting">Kole et al. (<a href="#ref-kole_forecasting" role="doc-biblioref">2017</a>)</span> who found that data frequency is more important than model choice for VaR forecasts.</p>
<p>We also found that replacing skewed-t NGARCH marginals with normal GARCH marginals for factor returns increased predictive accuracy and yielded better unconditional coverage. This may be because OLS residuals from the Carhart model capture most of the multivariate non-normality in stock returns.</p>
<p>For future research, it would be interesting to examine how the factor copula-DCC-GARCH model performs with larger portfolios, which would highlight the advantage of its dimensionality reduction. The only computationally expensive parts—fitting the DCC-GARCH structure and the copula—depend only on the number of factors, not the portfolio size.</p>
</section>
<section id="references" class="level2" data-number="5">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">5 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bollerslev_garch" class="csl-entry" role="listitem">
Bollerslev, Tim. 1986. <span>“Generalized Autoregressive Conditional Heteroskedasticity.”</span> <em>Journal of Econometrics</em> 31 (3): 307–27.
</div>
<div id="ref-Carhart1997" class="csl-entry" role="listitem">
Carhart, Mark M. 1997. <span>“On Persistence in Mutual Fund Performance.”</span> <em>The Journal of Finance</em> 52 (1): 57–82.
</div>
<div id="ref-CCTest" class="csl-entry" role="listitem">
Christoffersen, Peter F. 1998. <span>“Evaluating Interval Forecasts.”</span> <em>International Economic Review</em> 39 (4): 841–62.
</div>
<div id="ref-embrechts_2014" class="csl-entry" role="listitem">
Embrechts, Paul, Giovanni Puccetti, Ludger Rüschendorf, Ruodu Wang, and Antonela Beleraj. 2014. <span>“An Academic Response to Basel 3.5.”</span> <em>Risks</em> 2 (1): 25–48.
</div>
<div id="ref-DCC" class="csl-entry" role="listitem">
Engle, Robert. 2002. <span>“Dynamic Conditional Correlation: A Simple Class of Multivariate Generalized Autoregressive Conditional Heteroskedasticity Models.”</span> <em>Journal of Business &amp; Economic Statistics</em> 20 (3): 339–50.
</div>
<div id="ref-NGARCH" class="csl-entry" role="listitem">
Engle, Robert F, and Victor K Ng. 1993. <span>“Measuring and Testing the Impact of News on Volatility.”</span> <em>The Journal of Finance</em> 48 (5): 1749–78.
</div>
<div id="ref-FamaFrench" class="csl-entry" role="listitem">
Fama, Eugene F., and Kenneth R. French. 1993. <span>“Common Risk Factors in the Returns on Stocks and Bonds.”</span> <em>Journal of Financial Economics</em> 33 (1): 3–56.
</div>
<div id="ref-Fortin2022" class="csl-entry" role="listitem">
Fortin, Alain-Philippe, Jean-Guy Simonato, and Georges Dionne. 2022. <span>“Forecasting Expected Shortfall: Should We Use a Multivariate Model for Stock Market Factors?”</span> <em>International Journal of Forecasting</em> 39 (January).
</div>
<div id="ref-CPATests" class="csl-entry" role="listitem">
Giacomini, Raffaella, and Halbert White. 2006. <span>“Tests of Conditional Predictive Ability.”</span> <em>Econometrica</em> 74 (6): 1545–78.
</div>
<div id="ref-GJR" class="csl-entry" role="listitem">
Glosten, Lawrence R., Ravi Jagannathan, and David E. Runkle. 1993. <span>“On the Relation Between the Expected Value and the Volatility of the Nominal Excess Return on Stocks.”</span> <em>The Journal of Finance</em> 48 (5): 1779–1801.
</div>
<div id="ref-MN2004" class="csl-entry" role="listitem">
Haas, Markus, Stefan Mittnik, and Marc S Paolella. 2004. <span>“Mixed Normal Conditional Heteroskedasticity.”</span> <em>Journal of Financial Econometrics</em> 2 (2): 211–50.
</div>
<div id="ref-kole_forecasting" class="csl-entry" role="listitem">
Kole, Erik, Thijs Markwat, Anne Opschoor, and Dick Van Dijk. 2017. <span>“Forecasting Value-at-Risk Under Temporal and Portfolio Aggregation.”</span> <em>Journal of Financial Econometrics</em> 15 (4): 649–77.
</div>
<div id="ref-Paolella2006" class="csl-entry" role="listitem">
Paolella, Marc S, Keith Kuester, and Stefan Mittnik. 2006. <span>“Value-at-Risk Prediction: A Comparison of Alternative Strategies.”</span> <em>Journal of Financial Econometrics</em> 4 (1): 53–89.
</div>
<div id="ref-COMFORT_2015" class="csl-entry" role="listitem">
Paolella, Marc S., and Paweł Polak. 2015. <span>“COMFORT: A Common Market Factor Non-Gaussian Returns Model.”</span> <em>Journal of Econometrics</em> 187 (2): 593–605.
</div>
<div id="ref-Santos2013" class="csl-entry" role="listitem">
Santos, A. A. P., F. J. Nogales, and E. Ruiz. 2013. <span>“Comparing Univariate and Multivariate Models to Forecast Portfolio Value-at-Risk.”</span> <em>Journal of Financial Econometrics</em> 11 (2): 400–441.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>